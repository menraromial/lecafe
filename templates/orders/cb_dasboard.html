{% extends 'partials/base.html' %}

{% load static %}
{% block title %}Tableau de bord{% endblock title %}
{% block content %}


<section class="banner" style="background-image:url(/static/assets/img/background.png)">
   <div class="container">
      <div class="row align-items-center">
         <div class="col-lg-7">
            <div class="title-area-data">
               <h2>Tableau de bord</h2>
               <p>A magical combination that sent aromas to the taste buds</p>
            </div>
            <ol class="breadcrumb">
               <li class="breadcrumb-item">
                 <a href="{% url 'app:home' %}"><i class="fa-solid fa-house"></i> Accueil</a>
               </li>
               
               <li class="breadcrumb-item active" aria-current="page">Pannier</li>
            </ol>
         </div>
         <div class="col-lg-5">
            <div class="row">
               <div class="col-6">
                  <div class="title-area-img">
                     <img alt="title-area-img" src="{% static 'assets/img/title-area-img-1.jpg' %}">
                     <img alt="pata" class="pata" src="{% static 'assets/img/pata.png' %}">
                  </div>
               </div>
               <div class="col-6">
                  <div class="title-area-img two">
                     <img alt="title-area-img" src="{% static 'assets/img/title-area-img-2.jpg' %}">
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</section>
<section class="gap">
   {% if cart|length >= 1 %}
   <div class="container" id="cart-list-table-container">
      <div class="woocommerce-cart-form" id="cart-list-table">
            <div style="overflow-x:auto;overflow-y: hidden;">
              <table class="shop_table table-responsive">
                    <thead>
                        <tr>
                            <th class="product-name">Product</th>
                            <th class="product-quantity">quantité</th>
                            <th class="product-subtotal">Total</th>
                            <th class="product-subtotal">Supprimer</th>
                            <th class="product-subtotal">Rafraichir</th>
                        </tr>
                    </thead>
                    <tbody>
                     {% for item in cart %}
                        <tr>
                            <td class="product-name">
                                <img alt="img/{{item.item_title}}" height="50" width = "50" src="{{item.item_image}}">
                                <div>
                                    <a href="#">{{item.item_title}}</a>
                                    
                                </div>
                            </td>
                            <td class="product-quantity">
                                <input type="number" id="qty-{{item.id}}" class="input-text" value="{{item.quantity}}">
                                <input type="hidden" id="oqty-{{item.id}}" value="1">
                            </td>
                            <td class="product-subtotal">
                                <span class="woocommerce-Price-amount"><bdi><span class="woocommerce-Price-currencySymbol">fcfa </span><span id="price-{{item.id}}">{{item.total_price}}</span></bdi></span>
                            </td>
                            <td class="product-subtotal">
                              <button id="liveToastBtn" style="border: none;background-color: transparent;"><i class="fa fa-trash" style="color: #f3274c;" ></i>
                              </button>
                          </td>
                          <td class="product-subtotal">
                           {% csrf_token %}
                           <button data-bs-toggle="modal" data-bs-target="#exampleModal"  style="border: none;background-color: transparent;"><i class="fa fa-refresh" style="color: #8d8284;" aria-hidden="true"></i>
                           </button>
                       </td>
                        </tr>
                     {% endfor %}
                    </tbody>

              </table>
            </div>

      </div>
   </div>
   {% else %}
   <h2>Votre pannier est vide!! </>
   {% endif %}
</section>


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Details de la commande</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
           
            <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                <div class="col p-4 d-flex flex-column position-static">
                <strong class="d-inline-block mb-2 text-primary">World</strong>
                <h3 class="mb-0">Featured post</h3>
                <div class="mb-1 text-muted">Nov 12</div>
                <p class="card-text mb-auto">This is a wider card with supporting text below as a natural lead-in to additional content.</p>
                <a href="#" class="stretched-link">Continue reading</a>
                </div>
                <div class="col-auto d-none d-lg-block">
                <svg class="bd-placeholder-img" width="200" height="250" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#55595c"></rect><text x="50%" y="50%" fill="#eceeef" dy=".3em">Thumbnail</text></svg>
        
                </div>
            </div>
            <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                <div class="col p-4 d-flex flex-column position-static">
                <strong class="d-inline-block mb-2 text-primary">World</strong>
                <h3 class="mb-0">Featured post</h3>
                <div class="mb-1 text-muted">Nov 12</div>
                <p class="card-text mb-auto">This is a wider card with supporting text below as a natural lead-in to additional content.</p>
                <a href="#" class="stretched-link">Continue reading</a>
                </div>
                <div class="col-auto d-none d-lg-block">
                <svg class="bd-placeholder-img" width="200" height="250" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#55595c"></rect><text x="50%" y="50%" fill="#eceeef" dy=".3em">Thumbnail</text></svg>
        
                </div>
            </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>


  <!--TOAST-->
  <div class="position-fixed top-0 end-0 p-3" style="z-index: 11">
    <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header">
        <img src="{% static 'assets/img/logo.png' %}" class="rounded me-2" alt="...">
        <strong class="me-auto">Le Café</strong>
        <small>1 mins</small>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
      <div class="toast-body">
        Hey {{request.user.username}} ! Commande validé avec succès.
      </div>
    </div>
  </div>

  <script>
    var toastTrigger = document.getElementById('liveToastBtn')
    var toastLiveExample = document.getElementById('liveToast')
    if (toastTrigger) {
    toastTrigger.addEventListener('click', function () {
        var toast = new bootstrap.Toast(toastLiveExample)

        toast.show()
    })
}
  </script>

{% endblock content %}